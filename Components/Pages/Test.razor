@page "/test"
@using MudBlazor

<style>
    /* آیکن‌های مرتب‌سازی و فیلتر در هدر را مشکی کن */
    .mud-data-grid .mud-table-head,
    .mud-data-grid .mud-table-head .mud-th,
    .mud-data-grid .mud-table-head .mud-sort-label,
    .mud-data-grid .mud-table-head .mud-sort-label .mud-icon-root,
    .mud-data-grid .mud-table-head .mud-icon-button,
    .mud-data-grid .mud-table-head .mud-icon-root {
        color: #000 !important;
    }

    /* ردیف‌ها: یکی سبز، یکی زرد، یکی قرمز (تکرارشونده) */
    .mud-data-grid .mud-table-body .mud-tr:nth-child(3n+1) {
        background-color: #e8f5e9; /* سبز کمرنگ */
    }

    .mud-data-grid .mud-table-body .mud-tr:nth-child(3n+2) {
        background-color: #fffde7; /* زرد کمرنگ */
    }

    .mud-data-grid .mud-table-body .mud-tr:nth-child(3n) {
        background-color: #ffebee; /* قرمز کمرنگ */
    }
    /* روی هاور فقط کمی تیره‌تر شود و رنگ زمینه از بین نرود */
    .mud-data-grid .mud-table-body .mud-tr:hover {
        filter: brightness(0.98);
    }
</style>

<MudDataGrid @ref="DataGrid"
             T="Item"
             Items="@_items"
             SortMode="SortMode.Multiple"
             Filterable="true"
             FilterMode="DataGridFilterMode.ColumnFilterMenu"
             FilterCaseSensitivity="DataGridFilterCaseSensitivity.CaseInsensitive"
             Hover="true"
             Bordered="true">

    <Columns>
        <PropertyColumn Property="x => x.Name"
                        Title="Name"
                        Sortable="true"
                        Comparer="@(new MudBlazor.Utilities.NaturalComparer())" />
        <PropertyColumn Property="x => x.Value"
                        Title="Value"
                        Sortable="true" />
        <PropertyColumn Property="x => x.Misc"
                        Title="Misc"
                        Sortable="true" />
    </Columns>

    <PagerContent>
        <MudDataGridPager T="Item"
                          PageSize="10"
                          PageSizeOptions="new int[]{5,10,25,50}"
                          RowsPerPageString="ردیف در صفحه" />
    </PagerContent>
</MudDataGrid>

@code {
    private MudDataGrid<Item> DataGrid;

    private IEnumerable<Item> _items = new List<Item>()
    {
        new Item("1", 42, "555"),
        new Item("10", 73, "7"),
        new Item("2", 11, "4444"),
        new Item("1_10", 33, "33333"),
        new Item("1_2", 99, "66"),
        new Item("1_11", 44, "1111111"),
        new Item("0", 55, "222222")
    };

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && DataGrid is not null)
        {
            // مرتب‌سازی اولیه بر اساس Name به صورت Natural
            await DataGrid.SetSortAsync(nameof(Item.Name),
                                        SortDirection.Ascending,
                                        x => x.Name,
                                        new MudBlazor.Utilities.NaturalComparer());
        }
        await base.OnAfterRenderAsync(firstRender);
    }

    public class Item
    {
        public string Name { get; set; }
        public int Value { get; set; }
        public string Misc { get; set; }

        public Item(string name, int value, string misc)
        {
            Name = name;
            Value = value;
            Misc = misc;
        }
    }
}
